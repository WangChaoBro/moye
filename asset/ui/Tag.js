/*! 2015 Baidu Inc. All Rights Reserved */
define("ui/Tag",["require","jquery","./Control","./lib","./painter"],function(require){var t=require("jquery"),e=require("./Control"),i=(require("./lib"),e.extend({type:"Tag",options:{adapter:{toName:function(t){return t},toValue:function(t){return t}},value:[]},init:function(e){this.$parent(e),this.value=this.value&&this.value.length?this.value:t(this.main).data("value")||[]},initEvents:function(){this.delegate(this.main,"click",this._onMainClick)},repaint:require("./painter").createRepaint(e.prototype.repaint,{name:["value"],paint:function(t,e){var i=this.helper;if(this.value=e,!i.isInStage("INITED")||!e){for(var n=[],r=i.getPartClassName("item"),a=0,s=e.length;s>a;a++){var o=e[a],l=this.adapter.toName(o),u=this.adapter.toValue(o);n[a]='<a href="#" class="'+r+'" data-index="'+a+'" data-value="'+u+'" title="'+l+'">'+i.getPartHTML("content","span",l)+i.getPartHTML("remove","i","x")+"</a>"}this.main.innerHTML=n.join("")}}}),_onMainClick:function(e){var i=t(e.target),n=this.helper.getPrimaryClassName("remove");if(e.preventDefault(),i.hasClass(n)){var r=this.value,a=i.parent(),s=+a.data("index");this.setValue(r.slice(0,s).concat(r.slice(s+1))),this.fire("change")}},getValue:function(){return this.value},setValue:function(t){return this.value=null,this.set("value",t),this},add:function(t){this.setValue(this.value.concat(t))},remove:function(t){for(var e=this.value,i=this.value.length-1;i>=0;i--){var n=e[i];if(this.adapter.toValue(n)===t){this.setValue(e.slice(0,i).concat(e.slice(i+1)));break}}return this},getCount:function(){return this.value.length}}));return i});