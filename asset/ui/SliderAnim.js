/*! 2015 Baidu Inc. All Rights Reserved */
define("ui/SliderAnim",["require","jquery","./lib"],function(require){var t=require("jquery"),e=require("./lib"),i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)}}(),n=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||function(t){clearTimeout(t)}}(),r=e.browser.ie<9?function(t,e){if(1===e)t.style.filter="";else t.style.filter="alpha(opacity="+100*e+")"}:function(t,e){if(1===e)t.style.opacity="";else t.style.opacity=e},s=e.newClass({type:"SliderAnim",initialize:function(t,e){this.slider=t,this.options=e},switchTo:function(){},isBusy:function(){return!0},enable:function(){},disable:function(){},refresh:function(){},dispose:function(){this.slider=null,this.options=null}});return s.easing={easing:function(t){return t*=2,1>t?.5*t*t:-0.5*(--t*(t-2)-1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},backBoth:function(t){var e=1.70158;return t*=2,1>t?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},lineer:function(t){return t},bounce:function(t){if(1/2.75>t)return 7.5625*t*t;else if(2/2.75>t)return 7.5625*(t-=1.5/2.75)*t+.75;else if(2.5/2.75>t)return 7.5625*(t-=2.25/2.75)*t+.9375;return 7.5625*(t-=2.625/2.75)*t+.984375}},s.anims={},s.add=function(t,e){if(!this.anims[t])return this.anims[t]=e,!0;else return!1},s.TimeLine=s.extend({type:"TimeLine",initialize:function(e,i){this.$parent(e,i),this.slider=e,this.interval=i.interval||300,this.easingFn=s.easing[i.easing||"easing"],this.timeHandler=t.proxy(this.timeHandler,this)},beforeSwitch:function(){},switchTo:function(t,e){if(this.beforeSwitch(t,e),this.startTime=new Date,!this.timer)this.timer=i(this.timeHandler)},timeHandler:function(){var t=new Date-this.startTime;if(t>=this.interval)this.tick(1),this.timer=0;else this.tick(t/this.interval),this.timer=i(this.timeHandler)},isBusy:function(){return 0!==this.timer},disable:function(){n(this.timer),this.timer=0},dispose:function(){this.disable(),this.slider=null},tick:function(){}}),s.add("no",s.extend({type:"SliderAnimNo",switchTo:function(t){this.slider.stage.scrollLeft=this.slider.stageWidth*t}})),s.add("slide",s.TimeLine.extend({type:"SliderAnimSlide",initialize:function(t,e){this.$parent(t,e);var i=e.direction||"horizontal";this.yAxis="vertical"===i,t.helper.addPartClasses("stage-"+i),this.rollCycle=e.rollCycle||!1},beforeSwitch:function(e,i){var n=this.slider.stageWidth,r=this.slider.stageHeight,s=this.slider.count-1,a=t(this.slider.stage);if(this.rollCycle)if(!this.cycleNode)a.children().first().clone().appendTo(a),this.cycleNode=!0;if(this.yAxis){if(this.isBusy())this.curPos=a.scrollTop();else this.curPos=r*i;this.targetPos=r*e}else{if(this.isBusy())this.curPos=a.scrollLeft();else this.curPos=n*i;if(this.targetPos=n*e,this.rollCycle)if(0===e&&i===s)this.targetPos=n*(s+1);else if(e===s&&0===i&&!this.isBusy())this.curPos=n*(s+1)}},tick:function(t){var e=(this.targetPos-this.curPos)*this.easingFn(t),i=this.yAxis?"scrollTop":"scrollLeft";this.slider.stage[i]=this.curPos+e}})),s.add("opacity",s.TimeLine.extend({type:"SliderAnimOpacity",setOpacity:r,initialize:function(t,e){this.$parent(t,e),t.helper.addPartClasses("stage-opactiy")},beforeSwitch:function(i){var n=this.slider,r=n.helper,s=t(n.stage).children(),a=s.length;if(e.isUndefined(this.index))this.index=a-1;if(e.isUndefined(this.lastIndex))this.lastIndex=a-1;this.setOpacity(s[this.index],1),t(s[this.index]).removeClass(r.getPartClassName("top")),t(s[this.lastIndex]).removeClass(r.getPartClassName("cover")),t(s[this.index]).addClass(r.getPartClassName("cover")),this.lastIndex=this.index,t(s[this.index=i]).addClass(r.getPartClassName("top")),this.setOpacity(this.curElement=s[i],0)},tick:function(t){var e=this.easingFn(t);if(this.setOpacity(this.curElement,e),1===t)this.curElement=null},dispose:function(){this.curElement=null,this.$parent()}})),s});